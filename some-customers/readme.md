# ДЗ 17. Строим модель данных

## Схема

Новая схема лежит в файле `schema.sql`. Схема строилась для БД PostgreSQL.

Схема состоит из следующих таблиц:

- `customers`: информация о покупателях без адресов;
- `countries`: справочник стран;
- `cities`: справочник городов;
- `addresses`: собственно адреса, предполагается, что у каждого покупателя их может быть несколько.

## Импорт

Для импорта данных предполагается, что исходный csv-файл находится в подкаталоге `/data`. 

Я создавал контейнер командой:

`docker run --name postgres13 -e POSTGRES_PASSWORD=password -e POSTGRES_DB=some_customers -d -p 9876:5432 -v D:\otus-dbms\some-customers:/data postgres:13.2`

Создать схему можно запуском скрипта `schema.sql`. Собственно импорт выполняется скриптом `import.sql`.

Импорт выполняется, исходя из следующих предположений:

- Покупатели считаются идентичными, если у них совпадают имя, фамилия, дата рождения и гендер.
- Если имя и фамилия в строчке не заданы, считается, что это второй адрес предыдущего покупателя.

Отловить совсем все дубликаты адресов мне не удалось, но, кажется, это уже слишком трудоёмкая задача.